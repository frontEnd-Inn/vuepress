(window.webpackJsonp=window.webpackJsonp||[]).push([[42],{428:function(t,a,s){"use strict";s.r(a);var n=s(23),e=Object(n.a)({},(function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h2",{attrs:{id:"介绍"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#介绍"}},[t._v("#")]),t._v(" 介绍")]),t._v(" "),s("p",[t._v("referer （引用页），常用于防盗链，当使用 CDN、OSS 时经常会碰到类似的提示。")]),t._v(" "),s("blockquote",[s("p",[t._v("referer 正确英文为 referrer，但由于早期 HTTP 规范的拼写错误，为了保持向后兼容也就将错就错了。")])]),t._v(" "),s("h2",{attrs:{id:"配置"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#配置"}},[t._v("#")]),t._v(" 配置")]),t._v(" "),s("div",{staticClass:"language-nginx extra-class"},[s("pre",{pre:!0,attrs:{class:"language-nginx"}},[s("code",[t._v("Syntax"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\t"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("valid_referers")]),t._v(" none "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" blocked "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" server_names "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" string "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nDefault"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" —\nContext"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("server")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("location")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Example")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("location")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("valid_referers")]),t._v(" none blocked "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("example"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("com example"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" nginx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("example"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("top"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("foo"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("~")]),t._v("\\"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("google\\"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$invalid_referer")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("403")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("200")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'valid_referers\\n'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("h2",{attrs:{id:"测试"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#测试"}},[t._v("#")]),t._v(" 测试")]),t._v(" "),s("h3",{attrs:{id:"_1-example-com"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-example-com"}},[t._v("#")]),t._v(" 1. *.example.com")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("curl")]),t._v(" -e "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'http://dev.example.com'")]),t._v(" nginx.example.com\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 等价于")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("curl")]),t._v(" -H "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'referer: http://dev.example.com'")]),t._v(" nginx.example.com\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# HTTP/1.1 200 OK")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# valid_referers")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("curl")]),t._v(" -ie "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'http://dev.aexample.com'")]),t._v(" nginx.example.com\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# HTTP/1.1 403 Forbidden")]),t._v("\n")])])]),s("h3",{attrs:{id:"_2-example"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-example"}},[t._v("#")]),t._v(" 2. example.*")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("curl")]),t._v(" -ie "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'http://example.org'")]),t._v(" nginx.example.com\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# HTTP/1.1 200 OK")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# valid_referers")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("curl")]),t._v(" -ie "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'http://dev.example.org'")]),t._v(" nginx.example.com\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# HTTP/1.1 403 Forbidden")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("curl")]),t._v(" -ie "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'http://example.org/aaa'")]),t._v(" nginx.example.com\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# HTTP/1.1 200 OK")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# valid_referers")]),t._v("\n")])])]),s("h3",{attrs:{id:"_3-nginx-example-top-foo"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-nginx-example-top-foo"}},[t._v("#")]),t._v(" 3. nginx.example.top/foo/")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("curl")]),t._v(" -ie "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'http://nginx.example.top'")]),t._v(" nginx.example.com\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# HTTP/1.1 403 Forbidden")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("curl")]),t._v(" -ie "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'http://nginx.example.top/aaa'")]),t._v(" nginx.example.com\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# HTTP/1.1 403 Forbidden")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("curl")]),t._v(" -ie "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'http://nginx.example.top/foo'")]),t._v(" nginx.example.com\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# HTTP/1.1 403 Forbidden")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("curl")]),t._v(" -ie "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'http://nginx.example.top/foo/'")]),t._v(" nginx.example.com\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# HTTP/1.1 200 OK")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# valid_referers")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("curl")]),t._v(" -ie "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'http://nginx.example.top/foo/aa'")]),t._v(" nginx.example.com\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# HTTP/1.1 200 OK")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# valid_referers")]),t._v("\n")])])])])}),[],!1,null,null,null);a.default=e.exports}}]);